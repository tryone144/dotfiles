#!/bin/sh
#
# XINIT
# set relevant settings for specific wms including autostart
# (sourced by lightdm and .xinitrc)
#   needs: [dex]
#          [argyllcms]
#
# file: ~/.xprofile
# v1.5 / 2019.05.15
#
# (c) 2019 Bernd Busse
#

# set config dir and run autostart files with dapper
export WM_SCRIPTS="${HOME}/.local/share/wmscripts/"
export PATH="${PATH}:${WM_SCRIPTS%/}"

# set gnome-control-center variable
export XDG_CURRENT_DESKTOP=gnome

# set wm config locations
export AWESOME_CONFIG="${HOME}/.config/awesome/"
export I3_CONFIG="${HOME}/.config/i3/"

# forward session id to systemd units
systemctl --user import-environment XDG_SESSION_ID WM_SCRIPTS

# load Xresources
xrdb -merge -I${HOME} ~/.Xresources

# set primary display, if not already set
xrandr -d ${DISPLAY} --query | grep -e 'primary' &> /dev/null
if [[ ${?} == 1 ]]; then
    monitor="$(xrandr -d ${DISPLAY} --query | grep -e ' connected '| cut -d' ' -f1)"
    xrandr --output ${monitor} --primary
fi

# start 'unclutter' to hide cursor
unclutter --timeout 2 --jitter 20 --exclude-root --ignore-scrolling --fork

# set display calibration profiles
if [[ ${HOSTNAME} == "sachnix" ]]; then
    dispwin -d 1 -I ~/.local/share/colord/DELL\ U2410\ -\ 20150506.icc &
    dispwin -d 2 -I ~/.local/share/colord/SAMSUNG\ SyncMaster245B\ -\ 20150506.icc &
fi
